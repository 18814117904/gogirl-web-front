webpackJsonp([20,56,57],{"2el5":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={name:"card_rule_modify",props:["attr"],data:function(){var e=function(e,t,a){t!=parseFloat(t)?a(new Error("只能是数字")):t<0?a(new Error("不能为负数")):a()};return{cardrule:{chargeAmount:"",bestowAmount:"",discount:"",level:"",remark:""},rules:{chargeAmount:[{validator:e,trigger:"blur"}],bestowAmount:[{validator:e,trigger:"blur"}],discount:[{validator:function(e,t,a){t!=parseFloat(t)?a(new Error("只能是数字")):t<=0||t>1?a(new Error("输入大于0小于等于1")):a()},trigger:"blur"}],level:[{required:!0,message:"请输入会员等级",trigger:"blur"}]},hadSave:!1}},mounted:function(){this.getUserDetail()},methods:{modify:function(){var e=this;this.$refs.cardrule.validate(function(t){if(!t)return!1;e.hadSave=!0;var a=e.$BASE_USER_URL+"updateByPrimaryKeySelective",r=e.$axios.create({}),i=e.$qs.stringify({id:e.attr,chargeAmount:100*e.cardrule.chargeAmount,bestowAmount:100*e.cardrule.bestowAmount,discount:e.cardrule.discount,level:e.cardrule.level,remark:e.cardrule.remark});r.post(a,i).then(function(e){this.$layer.msg(e.data.message),1==e.data.success&&(this.hadSave=!0),this.$emit("updateClick")}.bind(e))})},getUserDetail:function(){this.$axios.create({}).get(this.$BASE_USER_URL+"selectByPrimaryKey",{params:{id:this.attr}}).then(function(e){this.cardrule=e.data.data.discountConfig,this.cardrule.chargeAmount=this.cardrule.chargeAmount/100,this.cardrule.bestowAmount=this.cardrule.bestowAmount/100}.bind(this))}}},i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",[a("el-form",{ref:"cardrule",attrs:{model:e.cardrule,rules:e.rules,"label-width":"100px"}},[a("div",{staticStyle:{"margin-bottom":"5px"}},[a("div",{staticClass:"fixed-table-container bootstrap-table"},[a("h3",{staticStyle:{"margin-top":"20px"}},[e._v("修改金额配置")]),e._v(" "),a("table",{staticClass:"table table-hover"},[a("tbody",[a("tr",[a("td",[a("el-form-item",{attrs:{label:"充值金额(元):",prop:"chargeAmount"}},[a("span",[a("el-input",{staticStyle:{"max-width":"100%"},attrs:{placeholder:"请输入 充值金额",required:""},model:{value:e.cardrule.chargeAmount,callback:function(t){e.$set(e.cardrule,"chargeAmount",t)},expression:"cardrule.chargeAmount"}})],1)])],1),e._v(" "),a("td",[a("el-form-item",{attrs:{label:"赠送金额:",prop:"bestowAmount"}},[a("span",[a("el-input",{staticStyle:{"max-width":"100%"},attrs:{placeholder:"请输入 赠送金额",required:""},model:{value:e.cardrule.bestowAmount,callback:function(t){e.$set(e.cardrule,"bestowAmount",t)},expression:"cardrule.bestowAmount"}})],1)])],1)]),e._v(" "),a("tr",[a("td",[a("el-form-item",{attrs:{label:"折扣:",prop:"discount"}},[a("span",[a("el-input",{staticStyle:{"max-width":"100%"},attrs:{placeholder:"请输入 折扣",required:""},model:{value:e.cardrule.discount,callback:function(t){e.$set(e.cardrule,"discount",t)},expression:"cardrule.discount"}})],1)])],1),e._v(" "),a("td",[a("el-form-item",{attrs:{label:"会员等级:",prop:"level"}},[a("span",[a("el-input",{staticStyle:{"max-width":"100%"},attrs:{placeholder:"请输入 会员等级",required:""},model:{value:e.cardrule.level,callback:function(t){e.$set(e.cardrule,"level",t)},expression:"cardrule.level"}})],1)])],1)]),e._v(" "),a("tr",[a("td",{attrs:{colspan:"2"}},[a("el-form-item",{attrs:{label:"备注:",prop:"remark"}},[a("span",[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.cardrule.remark,expression:"cardrule.remark"}],staticClass:"form-control",staticStyle:{"max-width":"100%"},attrs:{id:"remark"},domProps:{value:e.cardrule.remark},on:{input:function(t){t.target.composing||e.$set(e.cardrule,"remark",t.target.value)}}})])])],1),e._v(" "),a("td"),a("td")]),e._v(" "),a("tr",[a("td"),a("td"),a("td"),a("td")])])])])])])],1),e._v(" "),a("div",{staticStyle:{margin:"10px auto"}},[a("div",{staticStyle:{margin:"0 auto",width:"20%"}},[a("el-button",{attrs:{type:"primary",plain:"",disabled:e.hadSave},on:{click:e.modify}},[e._v("修改")])],1)])])};i._withStripped=!0;var l={render:i,staticRenderFns:[]},s=l;var n=a("VU/8")(r,s,!1,null,null,null);n.options.__file="src\\components\\member\\card_rule_modify.vue";t.default=n.exports},LGWm:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("2el5"),i=a("WA8i"),l={name:"serve_index",components:{card_rule_modify:r.default,card_rule_add:i.default},data:function(){return{members:[],pageInfo:{pageNum:1,pageSize:6,startRow:1,endRow:1,total:1,pages:1,prePage:0,nextPage:2,isFirstPage:!0,isLastPage:!0,hasPreviousPage:!1,hasNextPage:!0,lastPage:1,firstPage:1},addVisible:!1,UpDatePic:!1,nodetail:""}},mounted:function(){this.getAllType(this.pageInfo.pageNum)},methods:{handleSizeChange:function(e){this.pageInfo.pageSize=e,this.getAllType(this.pageInfo.pageNum)},handleCurrentChange:function(e){this.pageInfo.pageNum=e,this.getAllType(this.pageInfo.pageNum)},getAllType:function(e){var t=this.$BASE_USER_URL+"selectDiscount";this.$axios.create({}).get(t,{params:{pageNum:e,pageSize:this.pageInfo.pageSize}}).then(function(e){0!=e.data.success?(this.members=e.data.data.list,this.pageInfo=e.data.data):this.$layer.msg(e.data.message)}.bind(this)).catch(function(e){alert("getAllTypeAxios ERROE ! "+e)})},deleteType:function(e){var t=this;this.$confirm("此操作将永久删除该类型, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a=t.$BASE_USER_URL+"deleteByPrimaryKey";t.$axios.create({}).get(a,{params:{id:e}}).then(function(e){console.log(e.data.message),1==e.data.success&&(this.getAllType(this.pageInfo.prePage),this.$message({type:"success",message:"删除成功!"}))}.bind(t)).catch(function(e){alert("getAllServeAxios ERROE ! "+e)})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},create:function(){this.addVisible=!0},addClick:function(){this.addVisible=!1,this.getAllType(this.pageInfo.pageNum)},updateRule:function(e){this.nodetail=e,this.UpDatePic=!0},updateClick:function(){this.UpDatePic=!1,this.getAllType(this.pageInfo.pageNum)}}},s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-12"},[a("div",{staticClass:"ibox float-e-margins"},[e._m(0),e._v(" "),a("div",{staticClass:"wrapper wrapper-content animated fadeInRight",staticStyle:{padding:"0px"}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-12"},[a("div",{staticClass:"ibox-content m-b-sm",staticStyle:{display:"block","margin-bottom":"10px"}},[a("form",{attrs:{id:"toolbar",novalidate:"novalidate"}},[a("div",{staticClass:"form-inline search-form"},[a("div",{staticClass:"form-group",staticStyle:{"margin-left":"10px"}},[a("button",{staticClass:"btn btn-sm btn-danger",attrs:{type:"button"},on:{click:function(t){e.create()}}},[a("i",{staticClass:"fa fa-plus"}),e._v(" 新增规则\n                    ")])])])])]),e._v(" "),a("div",{staticClass:"ibox-content"},[a("div",{staticClass:"bootstrap-table"},[e._m(1),e._v(" "),a("div",{staticClass:"fixed-table-container",staticStyle:{"padding-bottom":"0px"}},[e._m(2),e._v(" "),a("div",{staticClass:"fixed-table-body",staticStyle:{width:"100%",height:"100%",overflow:"auto"}},[e._m(3),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.members,stripe:""}},[a("el-table-column",{attrs:{prop:"chargeAmount",label:"充值金额",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                         ￥ "+e._s(t.row.chargeAmount/100)+"\n                        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"bestowAmount",label:"赠送金额",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                         ￥ "+e._s(t.row.bestowAmount/100)+"\n                        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"discount",label:"折扣",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                          "+e._s(t.row.discount)+"\n                        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"level",label:"会员等级",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                          "+e._s(t.row.level)+"\n                        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"remark",label:"备注",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                          "+e._s(t.row.remark)+"\n                        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button-group",[a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(a){e.updateRule(t.row.id)}}},[e._v("修改")]),e._v(" "),a("el-button",{attrs:{type:"danger",plain:""},on:{click:function(a){e.deleteType(t.row.id)}}},[e._v("删除")])],1)]}}])})],1)],1),e._v(" "),a("div",{staticClass:"fixed-table-pagination",staticStyle:{"padding-top":"10px"},attrs:{align:"center"}},[a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"current-page":e.pageInfo.pageNum,"page-sizes":[6,12,18,24],"page-size":e.pageInfo.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.pageInfo.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])])]),e._v(" "),a("div",{staticClass:"clearfix"})])])])]),e._v(" "),a("div",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],staticClass:"tan"},[e.addVisible?a("el-dialog",{staticStyle:{"z-index":"10000",width:"100%",height:"90%"},attrs:{title:"新增金额配置",visible:e.addVisible,center:""},on:{"update:visible":function(t){e.addVisible=t}}},[a("card_rule_add",{on:{create:e.create,addClick:e.addClick}})],1):e._e()],1),e._v(" "),a("div",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],staticClass:"Tan"},[e.UpDatePic?a("el-dialog",{staticStyle:{"z-index":"10000",width:"100%",height:"98%"},attrs:{title:"修改金额配置",visible:e.UpDatePic,center:""},on:{"update:visible":function(t){e.UpDatePic=t}}},[a("card_rule_modify",{attrs:{attr:e.nodetail},on:{updateClick:e.updateClick,updateRule:e.updateRule}})],1):e._e()],1)])])])};s._withStripped=!0;var n={render:s,staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"ibox-title"},[t("h5",[this._v("会员卡规则管理")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"fixed-table-toolbar"},[t("div",{staticClass:"columns columns-right btn-group pull-right"})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"fixed-table-header",staticStyle:{display:"none"}},[t("table")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"fixed-table-loading",staticStyle:{top:"38px",display:"none"}},[t("img",{attrs:{src:"/content/image/loading.gif"}})])}]},o=n;var c=a("VU/8")(l,o,!1,null,null,null);c.options.__file="src\\components\\member\\card_rule.vue";t.default=c.exports},WA8i:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={name:"card_rule_add",data:function(){var e=function(e,t,a){t!=parseFloat(t)?a(new Error("只能是数字")):t<0?a(new Error("不能为负数")):a()};return{cardrule:{chargeAmount:"",bestowAmount:"",discount:"",level:"",remark:""},rules:{chargeAmount:[{validator:e,trigger:"blur"}],bestowAmount:[{validator:e,trigger:"blur"}],discount:[{validator:function(e,t,a){t!=parseFloat(t)?a(new Error("只能是数字")):t<=0||t>1?a(new Error("输入大于0小于等于1")):a()},trigger:"blur"}],level:[{required:!0,message:"请输入会员等级",trigger:"blur"}]},hadSave:!1}},mounted:function(){},methods:{create:function(){var e=this;this.$refs.cardrule.validate(function(t){if(!t)return!1;e.hadSave=!0;var a=e.$BASE_USER_URL+"insertSelective",r=e.$axios.create({}),i=e.$qs.stringify({chargeAmount:100*e.cardrule.chargeAmount,bestowAmount:100*e.cardrule.bestowAmount,discount:e.cardrule.discount,level:e.cardrule.level,remark:e.cardrule.remark});r.post(a,i).then(function(e){this.$layer.msg(e.data.message),1==e.data.success&&(this.hadSave=!0),this.$emit("addClick")}.bind(e))})}}},i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",[a("el-form",{ref:"cardrule",attrs:{model:e.cardrule,rules:e.rules,"label-width":"100px"}},[a("div",{staticStyle:{"margin-bottom":"5px"}},[a("div",{staticClass:"fixed-table-container bootstrap-table"},[a("h3",{staticStyle:{"margin-top":"20px"}},[e._v("修改金额配置")]),e._v(" "),a("table",{staticClass:"table table-hover"},[a("tbody",[a("tr",[a("td",[a("el-form-item",{attrs:{label:"充值金额(元):",prop:"chargeAmount"}},[a("span",[a("el-input",{staticStyle:{"max-width":"100%"},attrs:{placeholder:"请输入 充值金额",required:""},model:{value:e.cardrule.chargeAmount,callback:function(t){e.$set(e.cardrule,"chargeAmount",t)},expression:"cardrule.chargeAmount"}})],1)])],1),e._v(" "),a("td",[a("el-form-item",{attrs:{label:"赠送金额:",prop:"bestowAmount"}},[a("span",[a("el-input",{staticStyle:{"max-width":"100%"},attrs:{placeholder:"请输入 赠送金额",required:""},model:{value:e.cardrule.bestowAmount,callback:function(t){e.$set(e.cardrule,"bestowAmount",t)},expression:"cardrule.bestowAmount"}})],1)])],1)]),e._v(" "),a("tr",[a("td",[a("el-form-item",{attrs:{label:"折扣:",prop:"discount"}},[a("span",[a("el-input",{staticStyle:{"max-width":"100%"},attrs:{placeholder:"请输入 折扣",required:""},model:{value:e.cardrule.discount,callback:function(t){e.$set(e.cardrule,"discount",t)},expression:"cardrule.discount"}})],1)])],1),e._v(" "),a("td",[a("el-form-item",{attrs:{label:"会员等级:",prop:"level"}},[a("span",[a("el-input",{staticStyle:{"max-width":"100%"},attrs:{placeholder:"请输入 会员等级",required:""},model:{value:e.cardrule.level,callback:function(t){e.$set(e.cardrule,"level",t)},expression:"cardrule.level"}})],1)])],1)]),e._v(" "),a("tr",[a("td",{attrs:{colspan:"2"}},[a("el-form-item",{attrs:{label:"备注:",prop:"remark"}},[a("span",[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.cardrule.remark,expression:"cardrule.remark"}],staticClass:"form-control",staticStyle:{"max-width":"100%"},attrs:{id:"remark"},domProps:{value:e.cardrule.remark},on:{input:function(t){t.target.composing||e.$set(e.cardrule,"remark",t.target.value)}}})])])],1),e._v(" "),a("td"),a("td")]),e._v(" "),a("tr",[a("td"),a("td"),a("td"),a("td")])])])])])])],1),e._v(" "),a("div",{staticStyle:{margin:"10px auto"}},[a("div",{staticStyle:{margin:"0 auto",width:"20%"}},[a("el-button",{attrs:{type:"primary",plain:"",disabled:e.hadSave},on:{click:e.create}},[e._v("新增")])],1)])])};i._withStripped=!0;var l={render:i,staticRenderFns:[]},s=l;var n=a("VU/8")(r,s,!1,null,null,null);n.options.__file="src\\components\\member\\card_rule_add.vue";t.default=n.exports}});
//# sourceMappingURL=20.a5c60c32717f0f5687f1.1565068078403.js.map